<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabbed Interface</title>
    <style>
        body {
            display: flex;
            margin: 0;
            padding: 0;
            height: 100vh;
            background-color: black;
            border: 1px;
            font-family: Arial, sans-serif;
            color:white;
        }
        header, footer {
            color: white;
            text-align: center;
            padding: 10px 0;
            display: flex;
            justify-content: space-between;
            font-size: 60px;
            border: 1px solid white; /* Add white border */
        }
        header {
            background-color: rgb(11, 69, 11);
        }
        .header-section {
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .center-header {
            justify-content: center;
        }
        footer {
            background-color: rgb(0, 174, 255);
        }
        .footer-section {
            flex: 1;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .left-footer {
            justify-content: flex-start;
        }
        .center-footer {
            justify-content: center;
        }
        .right-footer {
            justify-content: flex-end;
        }

        #tab-container {
            display: flex;
            flex-direction: column;
            width: 80px;
            height: 100%;
            border: 1px solid red;
            background-color: rgb(35, 34, 34);
            color: whitesmoke;
            font-size: 50pt;
            
        }

        .tab {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 33%; 
            padding: 10px 5px;
            cursor: pointer;
            border: 1px solid blue;
            position: relative;
            
        }

        .tab span {
            transform: rotate(-90deg);
            transform-origin: center center;   
            white-space: nowrap;
        }

        .tab.active {
            background-color: slategray;
            font-weight: bold;
            border-left: 3px solid #000; /* Indicator for active tab */
            color: yellow;
        }

        #content-container {
            flex-grow: 1;
            padding: 0px;
            overflow: auto;
        }
    </style>
</head>
<body>
    

    <div id="tab-container">
        <div class="tab" onclick="loadContent('j1939_display.html', this)"><span>J1939</span></div>
        <div class="tab" onclick="loadContent('ballast_control.html', this)"><span>Ballast</span></div>
        <div class="tab" onclick="loadContent('remote_rudder.html', this)"><span>Autopilot</span></div>

    </div>
    <div id="content-container" class="tab-content">
        <!-- Content will be loaded here -->
    </div>

    <script>
        function loadContent(page, tabElement) {
            // Remove 'active' class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Add 'active' class to the clicked tab
            tabElement.classList.add('active');

            // Fetch and load the content
            fetch(page)
                .then(response => response.text())
                .then(data => {
                    document.getElementById('content-container').innerHTML = data;
                })
                .catch(error => console.error('Error loading content:', error));
        }

        // Load the first tab by default
        document.addEventListener('DOMContentLoaded', () => {
            const firstTab = document.querySelector('.tab');
            if (firstTab) {
                loadContent('j1939_display.html', firstTab);
            }
        });

        const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];

            const ws = new WebSocket('ws://localhost:8765');

            ws.onmessage = function(event) {
                const data = JSON.parse(event.data);
                tableBody.innerHTML = ''; // Clear the table body

                Object.keys(data.IDs).forEach(can_id => {
                    const idData = data.IDs[can_id];
                    const sourceData = data.Source;

                    Object.keys(sourceData).forEach(sa => {
                        const saData = sourceData[sa];

                        Object.keys(saData).forEach(pgn => {
                            if (pgn !== 'count') {
                                const row = tableBody.insertRow();

                                row.insertCell(0).textContent = can_id;
                                row.insertCell(1).textContent = idData.count;
                                row.insertCell(2).textContent = sa;
                                row.insertCell(3).textContent = pgn;
                                row.insertCell(4).textContent = saData[pgn].count;
                            }
                        });
                    });
                });
            };

            ws.onerror = function(event) {
                console.error('WebSocket error observed:', event);
            };
    </script>
</body>
</html>
